
library("plyr") 
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)

cities <- cities %>% 
  rename(Country = 'country',
         City ='city')

city <- cities %>% select("Country", "City")

complement2021 <- merge(complement2021, city, by="City")


# Comment évolue le bonheur au fil des années ?

Afin de voir comment évolue le bonheur au fil des années il est interressant de visualiser les différents histogrammes ci-après. 


# Histogramme global année 2016

data2016 <- filter(data, Year =='2016')

hist <- data %>% 
 mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde en 2016")
 
ggplotly(hist, aes(frame = Year))
# |> animation_opts(frame = 1500, transition = 500)

 
# Histogramme global année 2017

data2017 <- filter(data, Year =='2017')

data2017 %>% 
 mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde en 2017")
 
# Histogramme global année 2018

data2018 <- filter(data, Year =='2018')

data2018 %>% 
 mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde en 2018")
 
# Histogramme global année 2019

data2019 <- filter(data, Year =='2019')

data2019 %>% 
 mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde en 2019")

# Histogramme global année 2020

data2020 <- filter(data, Year =='2020')

data2020 %>% 
 mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde en 2020")

# Histogramme global année 2021

data2021 <- filter(data, Year =='2021')

data2021 %>% 
 mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde en 2021")
 
 
# Histogramme avec calcul de moyenne hapiness score sur 5 ans

data %>% group_by(Country, Region) %>% summarise_at(vars(Happiness_score), list(Happiness_score = mean)) %>% mutate_if(is.numeric, round) %>% ggplot(aes(Happiness_score, color = Region, fill = Region)) + geom_histogram(alpha = 0.5) + scale_x_continuous(breaks=seq(0,10, by = 1)) + scale_color_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + scale_fill_manual(values = c("#6c4292", "#2fd74a","#f76400","#9e0e0e", "#10cfab", "#df3d3d", "#d3cd0e", "#f8a925", "#1c64ab", "#126B2A")) + ggtitle("Niveau de bonheur des différentes régions du monde entre 2016 et 2021 (moyenne du hapinness score par pays)")



 

#Australia and New Zealand PROBLEME

dataANZ2016 <- filter(data, Region=='Australia and New Zealand', Year =='2016')
View (dataANZ2016)

dataANZ2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='Australia and New Zealand', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))

#Central and Eastern Europe

dataCEE2016 <- filter(data, Region=='Central and Eastern Europe', Year =='2016')


dataCEE2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='Central and Eastern Europe', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))

#Eastern Asia

dataEA2016 <- filter(data, Region=='Eastern Asia', Year =='2016')


dataEA2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='Eastern Asia', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))


#Latin America and Caribbean

dataLAC2016 <- filter(data, Region=='Latin America and Caribbean', Year =='2016')


dataLAC2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='Latin America and Caribbean', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))

#Middle East and Northern Africa

dataMENA2016 <- filter(data, Region=='Middle East and Northern Africa', Year =='2016')


dataMENA2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='Middle East and Northern Africa', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))

#North America PROBLEME

dataNA2016 <- filter(data, Region=='North America', Year =='2016')

dataNA2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='North America', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))

#Southeastern Asia



#Southern Asia

#Sub-Saharan Africa

#Western Europe 


dataWE2016 <- filter(data, Region=='Western Europe', Year =='2016')

dataWE2016 %>% 
 mutate_if(is.numeric, round) %>% filter(Region=='Western Europe', Year =='2016') %>% ggplot(aes(Happiness_score)) + geom_histogram() + scale_x_continuous(breaks=seq(0,10, by = 1))



data %>% filter(Region =='Western Europe') %>% group_by(Year) %>% summarize(Happiness_score = mean(Happiness_score)) %>%  ggplot(stat='identity')+ 
geom_line(aes(x=Year, y=Happiness_score)) 

data1 <- data %>% group_by(Year, Region) %>% summarize(Happiness_score = mean(Happiness_score))


View(data1)


data1 %>% filter(Region == 'Western Europe') %>% ggplot(aes(Happiness_score))+ 
geom_histogram() 

data %>% filter(Region =='Southern Asia') %>% group_by(Year) %>% summarize(Happiness_score = mean(Happiness_score)) %>% ggplot(stat='identity')+ geom_line(aes(x=Year, y=Happiness_score))

        
     
        
       
 

# Graphique moyenne


moyenne <- c(mean(X2015$'Happiness Score'), mean(X2016$'Happiness Score'), mean(X2017$'Happiness.Score'), mean(X2018$'Score'), mean(X2019$'Score'), mean(X2020$'Ladder score'), mean(X2021$'Ladder score'))

année <- c(2015, 2016, 2017, 2018, 2019, 2020, 2021)


df<-data.frame(moyenne, année)

df %>% ggplot(aes(année,moyenne))+ geom_point() 


#cherche a organiser en groupes de hapiness rank pour diagramme avec differentes Regions

for(i in 1:157){

  if(WE2015$Happiness_Rank[i] < 50 ){
    groupe1 <- WE2015$Happiness_Rank[i]
  }
}
group1


WE2015%>%ggplot() +
  geom_text(
    aes(x = Country, y= Happiness_Rank, label =Happiness_Rank)
  )
  





