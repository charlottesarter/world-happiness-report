```{r}
library(readr)
library(dplyr)

data2015 <- read.csv('../data/2015.csv')
data2016 <- read.csv('../data/2016.csv')
data2017 <- read.csv('../data/2017.csv')
data2018 <- read.csv('../data/2018.csv')
data2019 <- read.csv('../data/2019.csv')
data2020 <- read.csv('../data/2020.csv')
data2021 <- read.csv('../data/2021.csv')

data2015_corrected <- data2015 %>% 
  mutate(Lower_confidence_interval = Happiness.Score - Standard.Error, Upper_confidence_interval = Happiness.Score + Standard.Error, Year = 2015) %>%
  rename(Happiness_rank = Happiness.Rank, 
         Happiness_score = Happiness.Score,
         Standard_error = Standard.Error,
         Exp_by_economy_gdp_per_capita = Economy..GDP.per.Capita.,
         Explained_by_family = Family,
         Explained_by_life_expectancy = Health..Life.Expectancy.,
         Explained_by_freedom = Freedom,
         Explained_by_trust_government = Trust..Government.Corruption.,
         Explained_by_generosity = Generosity,
         Dystopia_residual = Dystopia.Residual)

data2016_corrected <- data2016 %>% 
  mutate(Standard.Error = Happiness.Score - Lower.Confidence.Interval, Year = 2016) %>%
  rename(Happiness_rank = Happiness.Rank, 
         Happiness_score = Happiness.Score,
         Standard_error = Standard.Error,
         Exp_by_economy_gdp_per_capita = Economy..GDP.per.Capita.,
         Explained_by_family = Family,
         Explained_by_life_expectancy = Health..Life.Expectancy.,
         Explained_by_freedom = Freedom,
         Explained_by_trust_government = Trust..Government.Corruption.,
         Explained_by_generosity = Generosity,
         Dystopia_residual = Dystopia.Residual,
         Lower_confidence_interval = Lower.Confidence.Interval,
         Upper_confidence_interval = Upper.Confidence.Interval)

data2017_corrected <- data2017 %>% 
  mutate(Standard_error = Happiness.Score - Whisker.low, Year = 2017) %>%
  rename(Happiness_rank = Happiness.Rank, 
         Happiness_score = Happiness.Score,
         Exp_by_economy_gdp_per_capita = Economy..GDP.per.Capita.,
         Explained_by_family = Family,
         Explained_by_life_expectancy = Health..Life.Expectancy.,
         Explained_by_freedom = Freedom,
         Explained_by_trust_government = Trust..Government.Corruption.,
         Explained_by_generosity = Generosity,
         Dystopia_residual = Dystopia.Residual,
         Lower_confidence_interval = Whisker.low,
         Upper_confidence_interval = Whisker.high)

# on n'a pas l'information de l'erreur standard pour 2018
data2018_corrected <- data2018 %>%
  mutate(Year = 2018) %>%
  rename(Country = Country.or.region, 
         Happiness_score = Score, 
         Happiness_rank = Overall.rank,
         Exp_by_economy_gdp_per_capita = GDP.per.capita,
         Explained_by_freedom = Freedom.to.make.life.choices, 
         Explained_by_trust_government = Perceptions.of.corruption, 
         Explained_by_social_support = Social.support,
         Explained_by_life_expectancy = Healthy.life.expectancy,
         Explained_by_generosity = Generosity) %>% 
  mutate(Explained_by_trust_government = as.double(Explained_by_trust_government))

data2019_corrected <- data2019 %>%
  mutate(Year = 2019) %>%
  rename(Country = Country.or.region, 
         Happiness_score = Score, 
         Happiness_rank = Overall.rank,
         Exp_by_economy_gdp_per_capita = GDP.per.capita,
         Explained_by_freedom = Freedom.to.make.life.choices, 
         Explained_by_trust_government = Perceptions.of.corruption, 
         Explained_by_social_support = Social.support,
         Explained_by_life_expectancy = Healthy.life.expectancy,
         Explained_by_generosity = Generosity) 

data2020_corrected <- data2020 %>%
  mutate(Year = 2020) %>%
  rename(Happiness_score = Ladder.score, 
         Country = Country.name, 
         Regional_indicator = Regional.indicator,
         Standard_error = Standard.error.of.ladder.score,
         Lower_confidence_interval = lowerwhisker, 
         Upper_confidence_interval = upperwhisker, 
         Logged_gpd_per_capita = Logged.GDP.per.capita,
         Social_support = Social.support,
         Life_expectancy = Healthy.life.expectancy,
         Freedom = Freedom.to.make.life.choices,
         Trust_government = Perceptions.of.corruption,
         Dystopia_score = Ladder.score.in.Dystopia,
         Exp_by_economy_gdp_per_capita = Explained.by..Log.GDP.per.capita,
         Explained_by_social_support = Explained.by..Social.support,
         Explained_by_life_expectancy = Explained.by..Healthy.life.expectancy, 
         Explained_by_freedom = Explained.by..Freedom.to.make.life.choices, 
         Explained_by_generosity = Explained.by..Generosity,
         Explained_by_trust_government = Explained.by..Perceptions.of.corruption,
         Dystopia_residual = Dystopia...residual)

data2021_corrected <- data2021 %>%
  mutate(Year = 2021) %>%
  rename(Happiness_score = Ladder.score, 
         Country = Country.name, 
         Regional_indicator = Regional.indicator,
         Standard_error = Standard.error.of.ladder.score,
         Lower_confidence_interval = lowerwhisker, 
         Upper_confidence_interval = upperwhisker, 
         Logged_gpd_per_capita = Logged.GDP.per.capita,
         Social_support = Social.support,
         Life_expectancy = Healthy.life.expectancy,
         Freedom = Freedom.to.make.life.choices,
         Trust_government = Perceptions.of.corruption,
         Dystopia_score = Ladder.score.in.Dystopia,
         Exp_by_economy_gdp_per_capita = Explained.by..Log.GDP.per.capita,
         Explained_by_social_support = Explained.by..Social.support,
         Explained_by_life_expectancy = Explained.by..Healthy.life.expectancy, 
         Explained_by_freedom = Explained.by..Freedom.to.make.life.choices, 
         Explained_by_generosity = Explained.by..Generosity,
         Explained_by_trust_government = Explained.by..Perceptions.of.corruption,
         Dystopia_residual = Dystopia...residual)

colnames(data2015_corrected)
colnames(data2016_corrected)
colnames(data2017_corrected)
colnames(data2018_corrected)
colnames(data2019_corrected)
colnames(data2020_corrected)
colnames(data2021_corrected)
  
```
```{r}

data <- data2015_corrected %>% 
  bind_rows(data2016_corrected) %>% 
  bind_rows(data2017_corrected) %>%
  bind_rows(data2018_corrected) %>%
  bind_rows(data2019_corrected) %>%
  bind_rows(data2020_corrected) %>%
  bind_rows(data2021_corrected)

data

```


